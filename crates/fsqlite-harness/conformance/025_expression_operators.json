{
  "id": "025_expression_operators",
  "description": "Expression operator parity: BETWEEN, IN, LIKE, GLOB, COALESCE, NULLIF, IIF, bitwise ops, CAST edge cases",
  "ops": [
    { "op": "open", "path": ":memory:" },

    { "op": "exec", "sql": "CREATE TABLE t1(id INTEGER PRIMARY KEY, val INTEGER, name TEXT)" },
    { "op": "exec", "sql": "INSERT INTO t1 VALUES (1, 10, 'alice'), (2, 20, 'bob'), (3, 30, 'charlie'), (4, 40, 'david'), (5, 50, 'eve')" },

    { "op": "query", "sql": "SELECT id FROM t1 WHERE val BETWEEN 20 AND 40 ORDER BY id", "expect": { "rows": [["2"], ["3"], ["4"]], "ordered": true } },
    { "op": "query", "sql": "SELECT id FROM t1 WHERE val NOT BETWEEN 20 AND 40 ORDER BY id", "expect": { "rows": [["1"], ["5"]], "ordered": true } },

    { "op": "query", "sql": "SELECT id FROM t1 WHERE val IN (10, 30, 50) ORDER BY id", "expect": { "rows": [["1"], ["3"], ["5"]], "ordered": true } },
    { "op": "query", "sql": "SELECT id FROM t1 WHERE val NOT IN (10, 30, 50) ORDER BY id", "expect": { "rows": [["2"], ["4"]], "ordered": true } },
    { "op": "query", "sql": "SELECT id FROM t1 WHERE name IN ('alice', 'eve') ORDER BY id", "expect": { "rows": [["1"], ["5"]], "ordered": true } },

    { "op": "query", "sql": "SELECT id FROM t1 WHERE val IN (SELECT val FROM t1 WHERE val > 30) ORDER BY id", "expect": { "rows": [["4"], ["5"]], "ordered": true } },

    { "op": "query", "sql": "SELECT name FROM t1 WHERE name LIKE 'a%'", "expect": { "rows": [["alice"]], "ordered": true } },
    { "op": "query", "sql": "SELECT name FROM t1 WHERE name LIKE '%e' ORDER BY id", "expect": { "rows": [["alice"], ["charlie"], ["eve"]], "ordered": true } },
    { "op": "query", "sql": "SELECT name FROM t1 WHERE name LIKE '_ob'", "expect": { "rows": [["bob"]], "ordered": true } },
    { "op": "query", "sql": "SELECT name FROM t1 WHERE name LIKE '%ar%'", "expect": { "rows": [["charlie"]], "ordered": true } },

    { "op": "query", "sql": "SELECT name FROM t1 WHERE name GLOB 'a*'", "expect": { "rows": [["alice"]], "ordered": true } },
    { "op": "query", "sql": "SELECT name FROM t1 WHERE name GLOB '*e' ORDER BY id", "expect": { "rows": [["alice"], ["charlie"], ["eve"]], "ordered": true } },
    { "op": "query", "sql": "SELECT name FROM t1 WHERE name GLOB '?ob'", "expect": { "rows": [["bob"]], "ordered": true } },

    { "op": "query", "sql": "SELECT COALESCE(NULL, NULL, 42)", "expect": { "rows": [["42"]], "ordered": true } },
    { "op": "query", "sql": "SELECT COALESCE(1, 2, 3)", "expect": { "rows": [["1"]], "ordered": true } },
    { "op": "query", "sql": "SELECT COALESCE(NULL, NULL, NULL)", "expect": { "rows": [[null]], "ordered": true } },

    { "op": "query", "sql": "SELECT NULLIF(5, 5)", "expect": { "rows": [[null]], "ordered": true } },
    { "op": "query", "sql": "SELECT NULLIF(5, 6)", "expect": { "rows": [["5"]], "ordered": true } },
    { "op": "query", "sql": "SELECT NULLIF('abc', 'abc')", "expect": { "rows": [[null]], "ordered": true } },

    { "op": "query", "sql": "SELECT IIF(1 > 0, 'yes', 'no')", "expect": { "rows": [["yes"]], "ordered": true } },
    { "op": "query", "sql": "SELECT IIF(1 < 0, 'yes', 'no')", "expect": { "rows": [["no"]], "ordered": true } },
    { "op": "query", "sql": "SELECT IIF(NULL, 'yes', 'no')", "expect": { "rows": [["no"]], "ordered": true } },

    { "op": "query", "sql": "SELECT 5 & 3", "expect": { "rows": [["1"]], "ordered": true } },
    { "op": "query", "sql": "SELECT 5 | 3", "expect": { "rows": [["7"]], "ordered": true } },
    { "op": "query", "sql": "SELECT 5 << 2", "expect": { "rows": [["20"]], "ordered": true } },
    { "op": "query", "sql": "SELECT 20 >> 2", "expect": { "rows": [["5"]], "ordered": true } },

    { "op": "query", "sql": "SELECT CAST('3.14' AS REAL)", "expect": { "rows": [["3.14"]], "ordered": true } },
    { "op": "query", "sql": "SELECT CAST(3.99 AS INTEGER)", "expect": { "rows": [["3"]], "ordered": true } },
    { "op": "query", "sql": "SELECT CAST('' AS INTEGER)", "expect": { "rows": [["0"]], "ordered": true } },
    { "op": "query", "sql": "SELECT CAST('abc' AS INTEGER)", "expect": { "rows": [["0"]], "ordered": true } },
    { "op": "query", "sql": "SELECT CAST('123abc' AS INTEGER)", "expect": { "rows": [["123"]], "ordered": true } },
    { "op": "query", "sql": "SELECT CAST(X'68656C6C6F' AS TEXT)", "expect": { "rows": [["hello"]], "ordered": true } }
  ],
  "fsqlite_modes": ["compatibility", "native"]
}
